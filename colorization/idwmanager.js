var IDWManager=function(i,b){var k=i;var j=b;var a=9999999;var e=3;var h;var f;this.setRadius=function(q){a=q};this.setPower=function(q){e=q};this.createIDWAsync=function(r,s,t,q,u){setTimeout(function(){var v=p.createIDW(r,s,t,q,u);u(v)},1)};this.createIDW=function(y,u,s,v){h=Number.MIN_VALUE;f=Number.MAX_VALUE;var r=c(u.latMin,u.lonMin,u.latMax,u.lonMax,s,v);var q=[];for(var w=0;w<y.length;w++){var t=o(r,y[w]);t.value=y[w].value;q.push(t)}var x=n(q,r.width,r.height);r.valueMatrix=x;if(k.getColors().length===0&&j){k=d(k,j,f,h)}r=m(r,q);return r};var n=function(r,w,z){var B=g(w,z);for(var A=0;A<w;A++){for(var y=0;y<z;y++){var G=0;var x=[];var q=0;for(var v=0;v<r.length;v++){if(r[v].x===A&&r[v].y===y){B[A][y]=r[v].value;break}var F=r[v].x-A;var E=r[v].y-y;var C=Math.sqrt(Math.pow(F,2)+Math.pow(E,2));if(C<a){var s=1/(Math.pow(C,e));G+=s;x.push(s*r[v].value)}}var D=0;for(var t=0;t<x.length;t++){D+=x[t]/G}f=(D<f)?D:f;h=(D>h)?D:h;B[A][y]=D}}B.minVal=f;B.maxVal=h;return B};var c=function(u,w,s,t,v,q){var r=document.createElement("canvas");r.id="idwRaster_"+(new Date()).getTime();r.width=v;r.height=q;r.latMin=u;r.lonMin=w;r.latMax=s;r.lonMax=t;return r};var o=function(s,r){var q=((r.lon-s.lonMin)/(s.lonMax-s.lonMin))*s.width;var t=((r.lat-s.latMin)/(s.latMax-s.latMin))*s.height;return{x:q,y:s.height-t}};var m=function(v,u){var w="";var t=v.width;var C=v.height;var s=new Uint8ClampedArray(t*C*4);var A=v.valueMatrix;var B=v.getContext("2d");var r=B.getImageData(0,0,v.width,v.height);var z=r.data;for(var y=0;y<t;y++){for(var x=0;x<C;x++){w=k.getColor(A[y][x]);var q=l(y,x,t);z[q]=w.red;z[q+1]=w.green;z[q+2]=w.blue;z[q+3]=255}}B.putImageData(r,0,0);return v};var d=function(r,w,q,x){var t=(x-q)/(w.length-1);var v=0;if(r.getType()===ColorManagerTypes.Classified){t=(x-q)/(w.length);v=1}for(var u=0;u<w.length;u++){var s=r.hexToColorWithValue(w[u],q+(Math.ceil(t)*(u+v)));r.addColor(s)}return r};var l=function(q,s,r){return(s*r+q)*4};var g=function(t){var q=new Array(t||0),s=t;if(arguments.length>1){var r=Array.prototype.slice.call(arguments,1);while(s--){q[t-1-s]=g.apply(this,r)}}return q};var p=this};