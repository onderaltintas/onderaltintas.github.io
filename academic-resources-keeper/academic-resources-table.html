<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akademik Kaynak Yönetimi v5</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 1300px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { color: #333; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 13px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #2c3e50; color: white; }
        tr:hover { background-color: #f9f9f9; }
        .form-section { margin-bottom: 20px; padding: 15px; border: 1px solid #eee; border-radius: 5px; background: #fafafa; display: flex; flex-wrap: wrap; gap: 8px; align-items: center; }
        .controls { margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; }
        input[type="text"] { padding: 8px; border: 1px solid #ccc; border-radius: 4px; flex: 1; min-width: 120px; }
        button { cursor: pointer; transition: 0.3s; font-weight: bold; padding: 8px 15px; border-radius: 4px; border: none; }
        .btn-add { background-color: #27ae60; color: white; }
        .btn-export { background-color: #8e44ad; color: white; }
        .btn-delete-row { background-color: #ff4757; color: white; padding: 4px 8px; font-size: 11px; }
        .btn-clear-db { background-color: #2f3542; color: white; }
        .checkbox-container { display: flex; align-items: center; gap: 5px; font-size: 12px; font-weight: bold; white-space: nowrap; }
    </style>
</head>
<body>

<div class="container">
    <h2>Tez Kaynak Takip Sistemi</h2>

    <div class="form-section">
        <input type="text" id="topicInput" placeholder="Konu Başlığı">
        <input type="text" id="titleInput" placeholder="Kaynak Adı ve Yıl">
        <input type="text" id="journalInput" placeholder="Dergi / Yayıncı">
        <input type="text" id="focusInput" placeholder="Odak Noktası">
        <input type="text" id="linkInput" placeholder="PDF Linki">
        <div class="checkbox-container">
            <input type="checkbox" id="usableInput"> İyi Kaynak?
        </div>
        <button onclick="addSource()" class="btn-add">Ekle</button>
    </div>

    <div class="controls">
        <button onclick="exportCSV()" class="btn-export">CSV Dışa Aktar</button>
        <button onclick="exportJSON()" class="btn-export">JSON Dışa Aktar</button>
        <input type="file" id="importFile" style="display:none" onchange="importJSON(event)">
        <button onclick="document.getElementById('importFile').click()" style="background:#f39c12; color:white;">JSON İçe Aktar</button>
        <button onclick="clearDatabase()" class="btn-clear-db">Veritabanını Sıfırla</button>
    </div>

    <table id="sourceTable">
        <thead>
            <tr>
                <th>Konu Başlığı</th>
                <th>Kaynak Adı ve Yıl</th>
                <th>Dergi / Yayıncı</th>
                <th>Odak Noktası</th>
                <th style="text-align: center;">İyi mi?</th>
                <th>PDF</th>
                <th>İşlem</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<script>
    // İstediğiniz üzere initialData boş
    const initialData = [];
    let db = JSON.parse(localStorage.getItem('art_sources_v5')) || initialData;

    function renderTable() {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        
        // Veriyi kaydedip tabloyu bas
        localStorage.setItem('art_sources_v5', JSON.stringify(db));

        db.forEach((item, index) => {
            const row = tbody.insertRow();
            row.insertCell(0).innerText = item.topic;
            row.insertCell(1).innerText = item.title;
            row.insertCell(2).innerText = item.journal;
            row.insertCell(3).innerText = item.focus;
            
            // İnteraktif Checkbox Hücresi
            const usableCell = row.insertCell(4);
            usableCell.style.textAlign = "center";
            const cb = document.createElement('input');
            cb.type = "checkbox";
            cb.checked = item.usable;
            cb.onchange = (e) => {
                db[index].usable = e.target.checked;
                localStorage.setItem('art_sources_v5', JSON.stringify(db));
            };
            usableCell.appendChild(cb);

            const linkCell = row.insertCell(5);
            const a = document.createElement('a');
            a.href = item.link;
            a.target = "_blank";
            a.innerText = "PDF";
            linkCell.appendChild(a);

            const actionCell = row.insertCell(6);
            const delBtn = document.createElement('button');
            delBtn.innerText = "Sil";
            delBtn.className = "btn-delete-row";
            delBtn.onclick = () => deleteRow(index);
            actionCell.appendChild(delBtn);
        });
    }

    function addSource() {
        const entry = {
            topic: document.getElementById('topicInput').value,
            title: document.getElementById('titleInput').value,
            journal: document.getElementById('journalInput').value,
            focus: document.getElementById('focusInput').value,
            usable: document.getElementById('usableInput').checked,
            link: document.getElementById('linkInput').value
        };
        if(!entry.topic || !entry.title) { alert("Konu ve Kaynak Adı zorunludur."); return; }
        db.push(entry);
        renderTable();
        document.querySelectorAll('.form-section input[type="text"]').forEach(i => i.value = '');
        document.getElementById('usableInput').checked = false;
    }

    function deleteRow(index) {
        if(confirm("Silmek istediğinize emin misiniz?")) {
            db.splice(index, 1);
            renderTable();
        }
    }

    function exportCSV() {
        let csvContent = "\uFEFFKonu Basligi;Kaynak Adi;Dergi;Odak Noktasi;Iyi Kaynak;Link\n";
        db.forEach(row => {
            csvContent += `${row.topic};${row.title};${row.journal};${row.focus};${row.usable ? "Evet" : "Hayir"};${row.link}\n`;
        });
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = "tez_kaynaklari.csv";
        link.click();
    }

    function exportJSON() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(db));
        const downloadNode = document.createElement('a');
        downloadNode.href = dataStr;
        downloadNode.download = "tez_kaynaklari.json";
        downloadNode.click();
    }

    function importJSON(event) {
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const imported = JSON.parse(e.target.result);
                db = [...db, ...imported];
                renderTable();
            } catch (err) { alert("Hata: Geçersiz dosya."); }
        };
        reader.readAsText(event.target.files[0]);
    }

    function clearDatabase() {
        if(confirm("Tüm veriler silinsin mi?")) {
            db = [];
            localStorage.removeItem('art_sources_v5');
            renderTable();
        }
    }

    renderTable();
</script>
</body>
</html>